<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>DialogBrain Cookie Sync - Options</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 600px;
      margin: 0 auto;
      padding: 24px;
      background: #f8f9fa;
      color: #1a1a1a;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 8px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 24px;
    }

    .section {
      background: white;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .section h2 {
      font-size: 16px;
      margin-bottom: 12px;
    }

    .option-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .option-row:last-child {
      border-bottom: none;
    }

    .option-label {
      font-size: 14px;
    }

    .option-description {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
    }

    .toggle {
      position: relative;
      width: 44px;
      height: 24px;
    }

    .toggle input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      border-radius: 24px;
      transition: 0.3s;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      border-radius: 50%;
      transition: 0.3s;
    }

    .toggle input:checked + .toggle-slider {
      background-color: #2563eb;
    }

    .toggle input:checked + .toggle-slider:before {
      transform: translateX(20px);
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      margin-right: 8px;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-secondary {
      background: #f3f4f6;
      color: #1a1a1a;
      border: 1px solid #e5e7eb;
    }

    .btn-secondary:hover {
      background: #e5e7eb;
    }

    .btn-danger {
      background: #fee2e2;
      color: #991b1b;
      border: 1px solid #fca5a5;
    }

    .btn-danger:hover {
      background: #fecaca;
    }

    .actions {
      margin-top: 24px;
    }

    .status-message {
      padding: 12px;
      border-radius: 6px;
      margin-top: 16px;
      display: none;
    }

    .status-message.success {
      background: #dcfce7;
      color: #166534;
      display: block;
    }

    .status-message.error {
      background: #fee2e2;
      color: #991b1b;
      display: block;
    }

    .info-box {
      padding: 12px;
      background: #f3f4f6;
      border-radius: 6px;
      font-size: 13px;
      color: #666;
    }

    .info-box code {
      background: #e5e7eb;
      padding: 2px 4px;
      border-radius: 3px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h1>DialogBrain Cookie Sync</h1>
  <p class="subtitle">Configure how the extension syncs your session cookies</p>

  <div class="section">
    <h2>Sync Settings</h2>

    <div class="option-row">
      <div>
        <div class="option-label">Auto-sync on cookie change</div>
        <div class="option-description">Automatically sync when cookies are updated</div>
      </div>
      <label class="toggle">
        <input type="checkbox" id="auto-sync" checked>
        <span class="toggle-slider"></span>
      </label>
    </div>

    <div class="option-row">
      <div>
        <div class="option-label">Periodic background sync</div>
        <div class="option-description">Sync every 6 hours as a fallback</div>
      </div>
      <label class="toggle">
        <input type="checkbox" id="periodic-sync" checked>
        <span class="toggle-slider"></span>
      </label>
    </div>
  </div>

  <div class="section">
    <h2>Development Mode</h2>

    <div class="option-row">
      <div>
        <div class="option-label">Use localhost API</div>
        <div class="option-description">Connect to http://localhost:8000 instead of production</div>
      </div>
      <label class="toggle">
        <input type="checkbox" id="dev-mode">
        <span class="toggle-slider"></span>
      </label>
    </div>

    <div class="info-box" style="margin-top: 12px;">
      <strong>Production API:</strong> <code>https://api.dialogbrain.com</code><br>
      <strong>Development API:</strong> <code>http://localhost:8000</code>
    </div>
  </div>

  <div class="section">
    <h2>Data Management</h2>

    <div class="option-row">
      <div>
        <div class="option-label">Clear stored data</div>
        <div class="option-description">Remove auth token and account IDs from extension</div>
      </div>
      <button class="btn btn-danger" id="clear-data-btn">Clear Data</button>
    </div>
  </div>

  <div class="actions">
    <button class="btn btn-primary" id="save-btn">Save Settings</button>
    <button class="btn btn-secondary" id="reset-btn">Reset to Defaults</button>
  </div>

  <div id="status-message" class="status-message"></div>

  <script>
    const autoSyncToggle = document.getElementById('auto-sync');
    const periodicSyncToggle = document.getElementById('periodic-sync');
    const devModeToggle = document.getElementById('dev-mode');
    const clearDataBtn = document.getElementById('clear-data-btn');
    const saveBtn = document.getElementById('save-btn');
    const resetBtn = document.getElementById('reset-btn');
    const statusMessage = document.getElementById('status-message');

    // Load settings
    async function loadSettings() {
      const settings = await chrome.storage.local.get([
        'auto_sync_enabled',
        'periodic_sync_enabled',
        'dev_mode',
      ]);

      autoSyncToggle.checked = settings.auto_sync_enabled !== false;
      periodicSyncToggle.checked = settings.periodic_sync_enabled !== false;
      devModeToggle.checked = settings.dev_mode === true;
    }

    // Save settings
    async function saveSettings() {
      await chrome.storage.local.set({
        auto_sync_enabled: autoSyncToggle.checked,
        periodic_sync_enabled: periodicSyncToggle.checked,
        dev_mode: devModeToggle.checked,
      });

      showStatus('Settings saved successfully', 'success');
    }

    // Reset to defaults
    async function resetSettings() {
      autoSyncToggle.checked = true;
      periodicSyncToggle.checked = true;
      devModeToggle.checked = false;
      await saveSettings();
    }

    // Clear data
    async function clearData() {
      if (!confirm('This will remove your auth token and account IDs. You will need to reconnect. Continue?')) {
        return;
      }

      await chrome.storage.local.remove([
        'auth_token',
        'instagram_account_id',
        'linkedin_account_id',
      ]);

      showStatus('Data cleared successfully', 'success');
    }

    // Show status message
    function showStatus(message, type) {
      statusMessage.textContent = message;
      statusMessage.className = `status-message ${type}`;

      setTimeout(() => {
        statusMessage.className = 'status-message';
      }, 3000);
    }

    // Event listeners
    saveBtn.addEventListener('click', saveSettings);
    resetBtn.addEventListener('click', resetSettings);
    clearDataBtn.addEventListener('click', clearData);

    // Load on init
    loadSettings();
  </script>
</body>
</html>
